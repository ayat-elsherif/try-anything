/**
 * @license
 * Copyright (c) 2022 The Nuevodebel Team. All rights reserved.
 * VTT Thumnails 
 * Version 2.0.0
 */
import videojs from"video.js";const defaults={width:160,height:90,basePath:"",src:""};var thumbTrack,tdiv;const registerPlugin=videojs.registerPlugin||videojs.plugin,onPlayerReady=(e,t)=>{function s(e){var t,s,i;if(-1===(s=e.indexOf("#")))return{src:e,w:0,h:0,x:0,y:0};t=e.substring(0,s);if("xywh="!==(i=e.substring(s+1)).substring(0,5))return{src:defaults.basePath+t,w:0,h:0,x:0,y:0};var a=i.substring(5).split(",");return{src:defaults.basePath+t,w:parseInt(a[2],10),h:parseInt(a[3],10),x:parseInt(a[0],10),y:parseInt(a[1],10)}}defaults.basePath="";""!==t.basePath&&(defaults.basePath=t.basePath);if(t.width&&t.height){defaults.width=t.width;defaults.height=t.height}var i=t;videojs.browser.TOUCH_ENABLED||e.on("medialoaded",function(t){var a,r=e.textTracks().length;if(0===r){tdiv&&videojs.dom.addClass("tdiv","vjs-hidden");return}let d=0;for(var l=!1,o=0;d<r;){if("metadata"===e.textTracks()[d].kind&&e.textTracks()[d].src&&(thumbTrack=e.textTracks()[d]).cues){l=!0;o=thumbTrack.cues.length;thumbTrack.mode="hidden";break}d++}if(!0===l)if(o<1)tdiv&&videojs.dom.addClass("tdiv","vjs-hidden");else{d=0;var h=e.controlBar.progressControl,n=e.el_.querySelector(".vjs-thumb-tooltip");null!==n&&n.parentNode.removeChild(n);var u=e.el_.querySelector(".vjs-thumb-image");null!==u&&u.parentNode.removeChild(u);var v=e.el_.querySelector(".vjs-thumbnail-holder");null!==v&&v.parentNode.removeChild(v);(tdiv=document.createElement("div")).className="vjs-thumbnail-holder";var c=document.createElement("div");c.className="vjs-thumb-tooltip";var m=document.createElement("img");tdiv.appendChild(m);m.className="vjs-thumb-image";tdiv.appendChild(c);h.el().appendChild(tdiv);var p=e.duration();e.on("durationchange",function(t){p=e.duration()});e.on("loadedmetadata",function(t){p=e.duration()});var f=this.el_.querySelector(".vjs-play-progress").querySelector(".vjs-time-tooltip");videojs.dom.addClass(f,"vjs-abs-hidden");var y=h.el().querySelector(".vjs-mouse-display");y.style.opacity=0;h.on("mousemove",b);h.on("mouseleave",g);e.on("userinactive",g)}else tdiv&&videojs.dom.addClass("tdiv","vjs-hidden");function b(t){var r=this.el_.querySelector(".vjs-mouse-display"),l=Number(r.style.left.replace(/px$/,"")),o=l/h.el().offsetWidth*p,n=y.querySelector(".vjs-time-tooltip");c.innerHTML=n.innerHTML;var u=thumbTrack&&thumbTrack.cues.length;d=0;for(var v=!1;d<u;){var f=thumbTrack.cues[d];if(f.startTime<=o&&f.endTime>=o){v=!0;a=s(f.text);break}d++}if(!0===v){tdiv.className="vjs-thumbnail-holder";c.style.opacity=1;a.src&&m.src!==a.src&&(m.src=a.src);if(0===a.w){a.w=i.width;m.style.width=a.w+"px"}if(0===a.h){a.h=i.height;m.style.height=a.h+"px"}if(tdiv.style.width!==a.w||tdiv.style.height!==a.h){tdiv.style.width=a.w+"px";tdiv.style.height=a.h+"px"}m.style.left=-a.x+"px";m.style.top=-a.y+"px";m.style.clip="rect("+a.y+"px,"+(a.w+a.x)+"px,"+(a.y+a.h)+"px,"+a.x+"px)";var b=a.w,g=b/2,j=h.el().offsetWidth,x=e.el_.querySelector(".vjs-progress-holder").offsetLeft,w=g-x;l+g+x>j?l=j-b:l<w?l=0:l-=w;tdiv.style.left=l+"px"}else{c.style.opacity=0;tdiv.className="vjs-thumbnail-holder vjs-thumb-hidden"}}function g(e){tdiv.style.left="-1000px"}})},thumbnails=function(e){this.ready(()=>{onPlayerReady(this,videojs.mergeOptions(defaults,e))})};registerPlugin("thumbnails",thumbnails);thumbnails.VERSION="1.1";export default thumbnails;