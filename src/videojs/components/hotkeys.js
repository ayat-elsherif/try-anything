import videojs from"video.js";const Plugin=videojs.getPlugin("plugin");class Hotkeys extends Plugin{constructor(e,t){super(e);var o=e.el(),r=document,n={volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!0,enableModifiersForNumbers:!0,playPauseKey:T,rewindKey:P,forwardKey:q,volumeUpKey:F,volumeDownKey:x,muteKey:D,fullscreenKey:M,customKeys:{}};videojs.options.blockKeys=!1;var l=1,i=2,u=3,a=4,c=5,s=6,m=7,v=videojs.mergeOptions||videojs.util.mergeOptions,y=(t=v(n,t||{})).volumeStep,f=t.seekStep,b=(t.enableMute,t.enableVolumeScroll),p=t.enableFullscreen,d=t.enableNumbers,h=t.enableJogStyle,k=t.alwaysCaptureHotkeys,w=t.enableModifiersForNumbers;o.hasAttribute("tabIndex")||o.setAttribute("tabIndex","-1");o.style.outline="none";!k&&e.autoplay()||e.one("play",function(){o.focus()});e.on("userinactive",function(){var t=function(){clearTimeout(n)},n=setTimeout(function(){e.off("useractive",t);r.activeElement.parentElement===o.querySelector(".vjs-control-bar")&&o.focus()},10);e.one("useractive",t)});e.on("play",function(){var e=o.querySelector(".iframeblocker");if(e&&""===e.style.display){e.style.display="block";e.style.bottom="39px"}});var K=function(n){var v,b=n.which;n.preventDefault;if(e.controls()){var K=r.activeElement;if(k||K===o||K===o.querySelector(".vjs-tech")||K===o.querySelector(".vjs-control-bar")||K===o.querySelector(".iframeblocker")){j(n,e);n.preventDefault();n.stopPropagation?n.stopPropagation():window.event&&(window.event.cancelBubble=!0);switch(j(n,e)){case l:n.stopPropagation?n.stopPropagation():window.event&&(window.event.cancelBubble=!0);e.paused()?e.play():e.pause();break;case i:n.stopPropagation();if(videojs.options.blockKeys)break;v=e.currentTime()-f;e.currentTime()<=f&&(v=0);e.currentTime(v);break;case u:n.stopPropagation();if(videojs.options.blockKeys)break;e.currentTime(e.currentTime()+f);break;case c:n.stopPropagation();if(videojs.options.blockKeys)break;if(h){v=e.currentTime()-1;e.currentTime()<=1&&(v=0);e.currentTime(v)}else e.volume(e.volume()-y);break;case a:if(videojs.options.blockKeys)break;h?e.currentTime(e.currentTime()+1):e.volume(e.volume()+y);break;case s:e.muted(!e.muted());break;case m:p&&(e.isFullscreen()?e.exitFullscreen():e.requestFullscreen());break;default:if((b>47&&b<59||b>95&&b<106)&&(w||!(n.metaKey||n.ctrlKey||n.altKey))&&d){var g=48;b>95&&(g=96);var S=b-g;e.currentTime(e.duration()*S*.1)}for(var T in t.customKeys){var P=t.customKeys[T];if(P&&P.key&&P.handler&&P.key(n)){n.preventDefault();P.handler(e,t)}}}}}},g=function(t){if(e.controls()){var n=t.relatedTarget||t.toElement||r.activeElement;n!==o&&n!==o.querySelector(".vjs-tech")&&n!==o.querySelector(".iframeblocker")||p&&(e.isFullscreen()?e.exitFullscreen():e.requestFullscreen())}},S=function(t){if(e.controls()){var n=t.relatedTarget||t.toElement||r.activeElement;if((k||n===o||n===o.querySelector(".vjs-tech")||n===o.querySelector(".iframeblocker")||n===o.querySelector(".vjs-control-bar"))&&b){t=window.event||t;var l=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));t.preventDefault();1===l?e.volume(e.volume()+y):-1===l&&e.volume(e.volume()-y)}}},j=function(e,o){return t.playPauseKey(e,o)?l:t.rewindKey(e,o)?i:t.forwardKey(e,o)?u:t.volumeUpKey(e,o)?a:t.volumeDownKey(e,o)?c:t.muteKey(e,o)?s:t.fullscreenKey(e,o)?m:void 0};function T(e){return 32===e.which||179===e.which}function P(e){return 37===e.which||177===e.which}function q(e){return 39===e.which||176===e.which}function F(e){return 38===e.which}function x(e){return 40===e.which}function D(e){return 77===e.which}function M(e){return 70===e.which}document.onkeydown=K;e.on("keydown",K);e.on("dblclick",g);e.on("mousewheel",S);e.on("DOMMouseScroll",S);return this}}videojs.registerPlugin("hotkeys",Hotkeys);export default Hotkeys;